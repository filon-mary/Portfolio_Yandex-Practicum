## Прогнозирование оттока телеком компании

# Цель исследования
1. Построить модель с максимально большим значением метрики AUC-ROC, которая спрогнозирует уход клиента.


# 1. План работы
1. Написание плана работы
2. Предобработка данных:
    * объединение данных,
    * генерация признаков, 
    * проверка датасета на пропуски, аномалии и т.д
3. Исследовательский анализ данных:
    * рассмотрим и проанализируем несколько признаков, а так же проведем анализ на корреляцию,
    * выдвижение гипотез,
    * написание выводов
4. Подготовка данных:
    * деление данных на выборки, 
    * кодировка и масштабирование данных, где это необходимо
5. Обучение моделей:
    * проводим настройки моделей, 
    * выбираем наилучшую модель - качество финальной модели должно быть больше значения основной метрики: AUC-ROC >= 0.85
6. Тестирование наилучшей модели:
    * проверяем наилучшую модель на тестовой выборке
7. Общий вывод
8. Отчет о проделанной работе


# Вывод
1. Мы познакомились с первоначальными данными
2. Данные разделены на четыре датасета:
    * Информация о договоре - 7043 записи и 8 столбцов, ежемесячные траты на услуги в среднем составляют 70.3 
    * Персональные данные клиента - 7043 записи и 5 столбцов
    * Информация об интернет-услугах - 5517 записи и 8 столбцов
    * Информация об услугах телефонии - 6361 записи и 2 столбца
3. Целевым признаком является:
    * EndDate — дата окончания пользования услугами   
4. Мы провели полноценную предобработку данных:
    * Объединили данные в единый датафрейм
    * Проверили датафрейм на пропуски и обработали их
    * Привели столбцы к корректному типу данных
    * Выделили целевую переменную - столбец Target
    * Сгенерировали допольнитейльный признак - столбец TotalDate
    * Проверили датасет на аномалии и дублкаты  
5. Мы провели исследовательский анализ данных
6. Рассмотрели и проанализировали признаки:
    * Большое количество клиентов пользовались услугами компании менее 200 дней. Примерно одинаковое количество клиентов используют услуги от 250 до 2500 дней. Подавляющее большинство клиентов пользуются услугами более 250 дней. 
    * Прирост клиентов с даты начала существования компания составил около 550 клиентов. После второй половины 2014 года наблюдается спад по количеству заключенных контрактов клиентами, однако вплоть до 2019 года показатели находятся на одном уровне - количество клиентов со второй половины 2014 года по 2019 год составляет от 120 до 300 клиентов. После второй половины 2019 года наблюдаеся резкий скачок клиентов, данный показатель больше показателя 2014 года, количество новых клиентов составило примерно 710 человек.
    * С начала существования компании и до 2015 года ушло менее 10 клиентов, однако после 2015 года отток клиентов начал возрастать. В периоды с 2017 года по вторую половину 2019 года количество ушедших клиентов варьировалось примерно от 40 до 80 человек. Наибольший отток клиентов пришелся на конец 2019 года - начало 2020, количество ушедших клиентов составило более 100 человек.
    * Большинство клиентов выбирают ежемесячный тип оплаты.
    * Большинство клиентов (59%) используют безналичный расчет 
    * Как мы можем наблюдать, у чуть больше половины (52%) клиентов нет супруга(и)
    * У 16% всех клиентов имеется пенсионный статус по возрасту
    * Наличие иждевенцев выявлено у 30% клиентов
7. Проанализировали ушедщих и действующих клиентов:       
    * Спустя полтора года пользования услугами связи, количество действующих клиентов начинает сокращаться. Пик ухода наблюдается, когда количество дней достигает 900 (два с половиной года), после преодоления этой отметки, количество уходов начинает сокращаться и стримится к минимуму, а действующие клиенты заметно увеличиваются
    * Большинство ушедших клиентов пользовались дорогими тарифами. Большинство действующих клиентов, наоборот, пользуются самым дешевым тарифом
    * Клиенты, которые ушли и имеют пенсионный статус - составляют меньше половины ушедших. Большинство действующих клиентов - не имеют пенсионный статус
    * У большинства ушедших клиентов имеется супруг(а), однако у большинства действующих клиентов нет супруга(и)
    * У большинства ушедших и действующих клиентов нет иждивенцев    
    
8. Провели анализ на корреляцию числовых признаков: 
    * Тесную связь между двумя признаками: TotalCharges – всего потрачено денег на услуги и TotalDate – количество дней использования услуг - корреляция равняется 0.82, что вполне логично, так как количество потраченных денег на услуги напрямую зависит от количества дней пользованиями услугами. Так же прослеживается умеренная связь между признаком TotalCharges – всего потрачено денег на услуги и признаком MonthlyCharges – ежемесячные траты на услуги. Практически никакой связи нет уу признака MonthlyCharges – ежемесячные траты на услуги и признака TotalDate – количество дней использования услуг.
    
9. Мы произвели подготовку данных:
    * Выполнили деление данных на выборки
    * Выполнили кодировку данных, где это необходимо  
10. Мы обучили различные модели машинного обучения:\
11. Провели настройки моделей, учитывая дисбаланс классов:
    * Лучшее значение AUC-ROC на тренировочной выборке модели случайного леса составляет 0.80 
    * Значение AUC-ROC на тренировочной выборке модели градиентного бустинга CatBoost составляет 0.90 
    * Значение AUC-ROC на тренировочной выборке модели градиентного бустинга LightGBM составляет 0.88
12. Выбрали наилучшую модель:
    * Наилучшей моделью оказалась модель градиентного бустинга: CatBoost с показателем 0.90 метрики AUC-ROC     
13. Мы провели тестирование наилучшей моедли - модели градиентного бустинга CatBoost:
     * Наилучшая модель градиентного бустинга CatBoost показала значение метрики AUC-ROC на тестовой выборке 0.89
     * Мы добились, чтобы качество финальной модели превышало значение основной метрики: AUC-ROC >= 0.85
     
**Рекомендации:** <br>
Мы построили отличную модель для прогнозирования оттока клиентов. С нашей моделью оператор связи «Ниединогоразрыва.ком» не только будет предсказывать, но и предотвращать уход клиента. Теперь компания может своевременно предлагать таким клиентам специальные предложения и условия, тем самым сохраняя клиентсткую базу и приобретая больше лояльных клиентов. С таким внимательным подходом к клиентам, компания расширит клиентскую базу и приумножит свои доходы.

# Стек технологий
Python, Pandas, LightGBM, CatBoost, Matplotlib, Scikit-learn

# Статус проекта
Завершен
