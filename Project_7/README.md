## Прогнозирование оттока клиента Банка

# Цель исследования
1. Построить модель с максимально большим значением F1-меры, которая спрогнозирует уход клиента из банка.


# Ход исследования
Данные о поведении клиентов, которые уже перешли на эти тарифы мы получим из файла '/datasets/Churn.csv'. О качестве данных ничего не известно, поэтому перед тем, как приступать к целям исследования, понадобится обзор данных. Мы проверим данные на ошибки.. Затем, на этапе предобработки мы будем искать возможность исправить все ошибки в данных, которые не приведут к искажению конечного результата. Далее приступим к целям исследования и построению наилучшей модели.<br>

Таким образом, исследование пройдёт в восемь этапов:<br>

• Обзор данных<br>
• Предобработка данных<br>
• Исследования баланса классов<br>
• Улучшение качества модели с учетом дисбаланса классов<br>
• Выявление лучшей модели<br>
• Написание промежуточных выводов<br>
• Проведение финального тестирования<br>
• Написание общего вывода

# Вывод
1. Мы ознакомились с представленным датафреймом и провели предобработку данных.<br>

2. Разделили исходные данные на обучающую, валидационную и тестовую выборки в соотношении 3:1:1.<br>

3. Применили прямое кодирование к категориальным данным, а так же масштабировали признаки.<br>

4. Выявили дисбаланс классов и исследовали качество разных моделей без учёта дисбаланса, меняя гиперпараметры:<br>
• Наилучшей моделью оказался случайный лес - F1-мера наилучшей модели на валидационной выборке составляет: 0.6016806722689076 при значении AUC-ROC: 0.8763013726699167;<br>
• Второй по значимости моделью является решающее дерево - F1-мера лучшей модели: 0.5939597315436241 при значении AUC-ROC: 0.8172638994704166;<br>
• Замыкающей моделью является логистическая регрессия - F1-мера наилучшей модели 0.3306772908366534 при значении AUC-ROC: 0.7892507409139087.<br>

5. Мы улучшили качество моделей, учитывая дисбаланс классов, применили три техники: взвешивание классов, upsampling и downsampling. <br>

6. Мы добились улучшения модели с помощью двух техник: взвешивания классов и уменьшения выборки (downsampling):<br>
• Наилучшей моделью является Random Forest - случайный лес: F1 наилучшей модели составляет 0.6468200270635995 при значении AUC-ROC: 0.8725087875835682.<br>
• И F1 наилучшей модели составляет 0.6508563899868247 при значении AUC-ROC: 0.8755506792564597.

7. Мы проверили модель на теcтовой выборке,  нам удалось достичь F1-меры не менее 0.59: <br>
• F1 наилучшей модели случайного леса на тестовой выборке составляет: 0.606993006993007 при AUC-ROC модели: 0.8469903649982875.<br>

**Рекомендации:** <br>
Мы выявили наилучшую модель (случайный лес, RandomForest), у которой была наивысшая точность среди всех моделей. Данная модель готова для исследования и внедрения в бизнес. С помощью модели случайного леса прогноз о том, уйдет клиент из банка в ближайшее время или нет - будет точным. Следовательно, с помощью правильного прогноза – «Бета-Банк» сможет выявить и попытаться сохранить клиента (предложить лояльные условия пользования банковскими продуктами, чтобы клиент оставался в компании как можно дольше и больше не намеревался уходить). Следовательно, чем точнее будет прогноз, тем больше шансов выявить уходящих клиентов и успеть предложить более выгодные условия, тем самым сохранив и клиентов и не понести убытков для компании. 

# Стек технологий
Python, Pandas, Matplotlib, Scikit-learn

# Статус проекта
Завершен
